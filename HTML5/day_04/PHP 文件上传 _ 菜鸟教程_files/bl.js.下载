/** retcode cloud sdk | @version 0.1.2 | @copyright Alibaba Group Holding Limited. */ !function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return o(n||e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){t.exports=function(t,n){var r,o=e("./util"),i=null,a=n.console?console.warn:o.noop;try{r=n.performance.timing.responseStart||Date.now()}catch(s){r=Date.now()}o.ext(t.prototype,{error:function(e,t){var n=this;if("object"!=typeof e||"string"!=typeof e.message)return n;var r=e.name||"CustomError",o=e.message,a=e.stack||"",s=r+o+a+(Date.now()/1e3|1);return i===s?this:(i=s,t=t||{},a=a?a.substring(0,1e3):undefined,this._lg("error",{cate:r,msg:o.substring(0,1e3),stack:a,file:t.filename,line:t.lineno,col:t.colno},1))},api:function(e,t,n,r,i){return"string"==typeof e&&(e={api:e,success:t,time:n,code:r,msg:i}),e=o.ext({code:"",msg:""},e),e.success=e.success?1:0,e.time=+e.time,!e.api||isNaN(e.time)?(a("[BL] Invalid time or api"),this):this._lg("api",e)},speed:function(e,t,n){var o=this,i=this.getConfig("startTime")||r;return/^s(\d|1[0])$/.test(e)?(t="number"!=typeof t?Date.now()-i:t>=i?t-i:t,o._spChe=o._spChe||{},o._spChe[e]=t,clearTimeout(o._spTmr),o._spTmr=setTimeout(function(){n||(o._spChe.page=o.getPage(!0)),o._lg("speed",o._spChe),o._spChe=null},5e3),o):(a("[BL] Invalid point: "+e),o)},sum:function(e,t,n){return this._lg("sum",{key:e,val:t||1},n)},avg:function(e,t,n){return this._lg("avg",{key:e,val:t||0},n)},percent:function(e,t,n,r){return this._lg("percent",{key:e,subkey:t,val:n||0},r)},custom:function(e,t){if(!e||"object"!=typeof e)return this;var n=!1,r={};return o.each(e,function(e,t){return!(n=t&&t.length<=20)&&a("[BL] Invalid key: "+t),r["x-"+t]=e,n}),n?this._lg("custom",r,t||1):this},msg:function(e,t){if(e&&!(e.length>130))return this._lg("custom",{"x-msg":e},t)}})}},{"./util":7}],2:[function(e,t,n){t.exports=function(t,n){var r=e("./util"),o=Date.now(),i={pid:null,page:null,ignoreUrlPath:[{rule:/(\w+)\/\d{2,}/g,target:"$1"},{rule:/([^\/]\/[^\/]+)(\/[^\/]+)\/.*$/,target:"$1$2/"}],ignoreApiPath:{rule:/(\w+)\/\d{2,}/g,target:"$1"},imgUrl:"https://arms-retcode.aliyuncs.com/r.png?",sample:1,disabled:!1,tag:"",disableHook:!1,startTime:null,enableSPA:!1,parseHash:function(e){return(e?e.replace(/^#/,"").replace(/\?.*$/,""):"")||"[index]"},parseResponse:function(e){if(!e||"object"!=typeof e)return{};var t=e.code,n=e.msg||e.message||e.subMsg||e.errorMsg||e.ret||e.errorResponse||"";return"object"==typeof n&&(t=t||n.code,n=n.msg||n.message||n.info||n.ret||JSON.stringify(n)),{msg:n,code:t,success:!0}}},a=function(e){var t=this;t.session=r.uu(),t._conf=r.ext({},i),t._samps={},t._reqQueue=[],t._reqTmr=undefined,t._spChe=null,t._spTmr=null;var n=(o++).toString(16);return t.hash=function(){return n},t.setConfig(e,!0),t._initHandler(),t._initHook(),"function"==typeof Object.defineProperty&&Object.defineProperty(t,"pipe",{set:t._sendPipe}),t};return a.prototype={constructor:a,getConfig:function(e){return e?this._conf[e]:r.ext({},this._conf)},setConfig:function(e,t){if(e&&"object"==typeof e){if("sample"in e){var n=e.sample,o=parseFloat(n);/^\d+(\.\d+)?%$/.test(n)&&(o/=100),o>0&&o<=1?e.sample=o:delete e.sample}"bTVwAAAADlYBCNzXE4Zw"===e.pid&&(e.pid="j9rqmq4ymm@968d8922eacdc55");var i=this,a=this._conf;return this._conf=r.ext({},a,e),t?this:("disableHook"in e&&a.disableHook!==e.disableHook&&(e.disableHook?i.removeHook():i.addHook()),"enableSPA"in e&&a.enableSPA!==e.enableSPA&&i._bindHashChange(e.enableSPA),this)}},getPage:function(e){var t=this._conf,n=t.page,o=location;return n&&!e?r.xcall(n,[],n+""):r.fbr(o.host+o.pathname,t.ignoreUrlPath)},setPage:function(e,t){var n=this,o=n._prevPage;return e&&e!==o?(n._prevPage=e,!1!==t&&(clearTimeout(n._sendPvTmr),n._handleUnload(),n.session=r.uu(),n._sendPvTmr=setTimeout(function(){n._sendPv()},2e3)),n._conf.page=e,n):n},sampling:function(e){return 1===e||("boolean"==typeof this._samps[e]?this._samps[e]:(this._samps[e]=r.pick(e),this._samps[e]))},onReady:function(e){var o=this;if(o.hasLoad)return e();"complete"===n.readyState?(o.hasLoad=!0,e()):r.on(t,"load",function(){o.hasLoad=!0,e()},!0)},createInstance:function(e){e=r.ext({pid:this.getConfig("pid")},e);var t=new a(e);return e.page&&t._sendPv(),t}},a.ver="0.1.2",e("./serv")(a,t),e("./api")(a,t),e("./handler")(a,t,n),e("./hook")(a,t),a}(window,document)},{"./api":1,"./handler":3,"./hook":4,"./serv":6,"./util":7}],3:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=null,a=r.documentElement,s={sr:screen.width+"x"+screen.height},u=function(){var e=n.innerWidth||a.clientWidth||r.body.clientWidth,t=n.innerHeight||a.clientHeight||r.body.clientHeight,i=o.cookie("_nk_")||o.cookie("_bl_uid");i||(i=o.uu(),o.cookie("_bl_uid",i,15552e3));var u={uid:i,dt:r.title,dl:location.href,dr:r.referrer,dpr:n.devicePixelRatio||1,de:(r.characterSet||r.defaultCharset||"").toLowerCase(),ul:a.lang,vp:e+"x"+t};return s.vp=u.vp,u},c=["navigationStart","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domCompleted","loadEventStart","loadEventEnd","msFirstPaint","secureConnectionStart"],f=function(){var e=n.performance;if(!e||"object"!=typeof e)return null;var t={dns:[3,2],tcp:[5,4],ssl:[5,17],ttfb:[7,6],trans:[8,7],dom:[10,9],res:[14,12],firstbyte:[7,2],fpt:[9,0,1],tti:[10,0,1],ready:[12,0,1],load:[14,0,1]},r={},i=e.timing||{};o.each(t,function(e,t){var n=i[c[e[1]]],o=i[c[e[0]]];if(!n&&e[2]&&(n=i[c[e[2]]]),n>0&&o>0){var a=o-n;a>=0&&a<36e5&&(r[t]=a)}});var a=n.navigator,u=a.connection||a.mozConnection||a.webkitConnection,f=e.navigation||{};if(r.ct=u?u.type:"",r.bandwidth=u?u.downlinkMax||u.bandwidth||-1:-1,r.fs=i[c[1]],r.navtype=1===f.type?"Reload":"Other","object"==typeof n.chrome)try{var l=chrome.loadTimes(),p=l.firstPaintTime,d=l.requestTime;if(p>0&&d>0){var h=Math.round(1e3*(p-d));h>=0&&h<36e5&&(r.fpt=h)}r.navtype=l.navigationType,r.protocol=l.connectionInfo}catch(g){}else i[c[16]]>0&&i[c[1]]>0&&(r.fpt=i[c[16]]-i[c[1]]);return s.ct=r.ct,r};return o.ext(t.prototype,{activeErrHandler:function(e){return i&&!e?this:(i=this,this)},errorHandler:function(e){var t=this;if(!e)return t;var n=e.type;return"error"===n?t.error(e.error||{message:e.message},e):"unhandledrejection"===n&&o.T(e.reason,"Error")&&t.error(e.reason),t},_sendPerf:function(){var e=this;return e.onReady(function(){var t=f();t&&(t.page=e.getPage(!0),e._lg("perf",t))}),e},_sendPv:function(){var e=this;return e.onReady(function(){var t=u();t&&e._lg("pv",t)}),e},_commonInfo:function(){return s},_handleUnload:function(){var e=this;e._spChe&&(e._lg("speed",e._spChe),e._spChe=null,clearTimeout(e._spTmr)),e._clear()},_bindHashChange:function(e){var t=this;if(!e^t._hashHdr)return t;e?(t._hashHdr=function(){var e=t._conf.parseHash(location.hash);t.setPage(e,!0)},o.on(n,"hashchange",t._hashHdr)):(o.off(n,"hashchange",t._hashHdr),t._hashHdr=null)},_initHandler:function(){var e=this;if(e._hasInitHandler)return e;var t=e._conf;return o.on(n,"beforeunload",function(){e._handleUnload()}),e._bindHashChange(t.enableSPA),e.activeErrHandler(!1),e._hasInitHandler=!0,e}}),o.on(n,"error",function(e){i&&i.errorHandler(e)}).on(n,"unhandledrejection",function(e){i&&i.errorHandler(e)}),t}},{"./util":7}],4:[function(e,t,n){t.exports=function(t,n){var r=e("./util"),o=null,i=["catch"],a=function(){"function"==typeof n.fetch&&function(e){n.__oFetch=e,n.fetch=function(t){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),s=o;if(!s||!s.api)return e.apply(n,a);var u=Date.now(),c=s._conf,f=(t&&"string"!=typeof t?t.url:t)||"",l=f;return f=f.replace(/\?.*$/,""),f=r.fbr(f,c.ignoreApiPath),e.apply(n,a).then(function(e){if(!s||!s.api)return e;var t=e.clone(),n=Date.now()-u;return t.ok?t.text().then(function(e){var o=r.J(e)||null,i=r.xcall(c.parseResponse,[o,l],{});i.code=i.code||t.status||200,i.success=!("success"in i)||i.success,s.api(f,i.success,n,i.code,i.msg)}):s.api(f,!1,n,t.status||404,t.statusText),e})[i[0]](function(e){if(!s||!s.api)throw e;var t=Date.now()-u;throw s.api(f,!1,t,e.name||"Error",e.message),e})},n.fetch.toString=function(){return"fetch() { [native code] }"}}(n.fetch)},s=function(){n.__oFetch&&(n.fetch=n.__oFetch,delete n.__oFetch)},u=function(){"function"==typeof n.XMLHttpRequest&&function(e){n.__oXMLHttpRequest=e,n.XMLHttpRequest=function(t){var n=new e(t),i=o;if(!i||!i.api||!n.addEventListener)return n;var a,s,u=n.send,c=n.open,f=i._conf;return n.open=function(e,t){var o=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);c.apply(n,o),s=(t||"").replace(/\?.*$/,""),s=s?r.fbr(s,f.ignoreApiPath):""},n.send=function(){a=Date.now();var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);u.apply(n,e)},r.on(n,"readystatechange",function(){if(s&&4===n.readyState){var e=Date.now()-a;if(n.status>=200&&n.status<=299){var t=r.J(n.responseText)||null,o=r.xcall(f.parseResponse,[t,s],{}),u=o.code||n.status||200,c=!("success"in o)||o.success;i.api(s,c,e,u,o.msg)}else i.api(s,!1,e,n.status||"FAILED",n.statusText)}}),n},n.XMLHttpRequest.toString=function(){return"XMLHttpRequest() { [native code] }"}}(n.XMLHttpRequest)},c=function(){n.__oXMLHttpRequest&&(n.XMLHttpRequest=n.__oXMLHttpRequest,delete n.__oXMLHttpRequest)};return r.ext(t.prototype,{removeHook:function(e){return o&&(e||this===o)?(s(),c(),o=null,this):this},addHook:function(e){return!e&&o?this:(o||(a(),u()),o=this,this)},_initHook:function(){return this._hasInitHook?this:(this.getConfig("disableHook")||this.addHook(),this._hasInitHook=!0,this)}}),t}},{"./util":7}],5:[function(e,t,n){Date.now=Date.now||function(){return(new Date).getTime()},t.exports=function(t){var n=t.BrowserLogger=e("./core"),r="__bl";if(t.__hasInitBlSdk)return n;var o={},i=[];r in t&&(o=t[r].config||{},i=t[r].pipe||[]);var a=t[r]=new n(o);a._sendPipe(i);var s=a._conf;return!1!==s.autoSendPv&&setTimeout(function(){s.enableSPA&&a._hashHdr?a._hashHdr():a._sendPv()},1500),a._sendPerf(),t.__hasInitBlSdk=!0,n}(window)},{"./core":2}],6:[function(e,t,n){t.exports=function(t,n){var r=e("./util"),o=Date.now(),i=n.console?console.warn:r.noop,a=/^(error|api|speed|sum|avg|percent|custom|msg|setPage|setConfig)$/,s=function(e,t){"object"==typeof t&&(t=r.serialize(t));var i="__request_hold_"+(o++).toString(36),a=n[i]=new Image;a.onload=a.onerror=function(){n[i]=undefined},a.src=e.getConfig("imgUrl")+t,a=null},u=function(e,t){var n;return"error"===t.t&&(n=e._reqQueue[0])&&"error"===n.t&&t.msg===n.msg?(n.times++,e):(e._reqQueue.unshift(t),e.onReady(function(){e._reqTmr=r.delay(function(){e._clear()},"error"===t.t?3e3:-1)}),e)};return r.ext(t.prototype,{_clear:function(){var e,t=this;for(clearTimeout(t._reqTmr),t._reqTmr=null;e=t._reqQueue.pop();)s(t,e);return t},_sendPipe:function(e){var t=this;if(!e||!e.length)return t;if("Array"===r.T(e[0]))return r.each(e,function(e){return t._sendPipe(e)});var n=e.shift();if(!a.test(n))return t;try{t[n].apply(t,e)}catch(o){i("[BL] Error in sendPipe",o)}},_lg:function(e,n,i){var a=this,s=a._conf;return i=i||s.sample,n&&!s.disabled&&s.pid&&a.sampling(i)?(n=r.ext({t:e,times:1,page:a.getPage(),tag:s.tag||""},n,a._commonInfo(),{pid:s.pid,_v:t.ver,sample:i,sid:a.session,z:(o++).toString(36)}),u(a,n)):a}}),t}},{"./util":7}],7:[function(e,t,n){t.exports=function(e,t){var n={};return{noop:function(){},each:function(e,t){var n=0,r=e.length;if(this.T(e,"Array"))for(;n<r&&!1!==t.call(e[n],e[n],n);n++);else for(n in e)if(!1===t.call(e[n],e[n],n))break;return e},xcall:function(t,n,r){if("function"!=typeof t)return r;try{return t.apply(e,n)}catch(o){return r}},T:function(e,t){var n=Object.prototype.toString.call(e).substring(8).replace("]","");return t?n===t:n},fbr:function(e,t){if(!e)return"";if(!t)return e;var n=this,r=n.T(t);return"Function"===r?n.xcall(t,[e],e):"Array"===r?(n.each(t,function(t){e=n.fbr(e,t)}),e):"Object"===r?e.replace(t.rule,t.target||""):e.replace(t,"")},J:function(e){if(!e||"string"!=typeof e)return e;var t=null;try{t=JSON.parse(e)}catch(n){}return t},pick:function(e){return 1===e||1===Math.ceil(Math.random()/e)},on:function(e,t,n,r){return e.addEventListener?e.addEventListener(t,function o(i){r&&e.removeEventListener(t,o,!1),n&&n.call(this,i)},!1):e.attachEvent&&e.attachEvent("on"+t,function i(o){r&&e.detachEvent("on"+t,i),n&&n.call(this,o)}),this},off:function(e,t,n){return n?(e.removeEventListener?e.removeEventListener(t,n):e.detachEvent&&e.detachEvent(t,n),this):this},delay:function(e,t){return-1===t?(e(),null):setTimeout(e,t||0)},ext:function(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},uu:function(){for(var e,t,n=20,r=new Array(n),o=Date.now().toString(36).split("");n-- >0;)t=(e=36*Math.random()|0).toString(36),r[n]=e%3?t:t.toUpperCase();for(var i=0;i<8;i++)r.splice(3*i+2,0,o[i]);return r.join("")},cookie:function(e,r,o,i,a){if(r===undefined){var s;return n[e]||(s=new RegExp(e+"=([^;]+)").exec(t.cookie))&&(n[e]=s[1]),n[e]}var u=e+"="+r;return i&&(u+="; domain="+i),a&&(u+="; path="+a),o&&(u+="; max-age="+o),t.cookie=u},encode:function(e){try{e=encodeURIComponent(e)}catch(t){}return e},serialize:function(e){e=e||{};var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==undefined&&t.push(n+"="+this.encode(e[n]));return t.join("&")},log:function(e,t,n,r){}}}(window,document)},{}]},{},[5]);